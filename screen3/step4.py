# 엑셀에 입력하여 분석

import openpyxl

class step4_cls:
    def make_step4(self, number):
        
        num = number
        
        # 엑셀 파일 열기
        wb = openpyxl.load_workbook('F:/JusikData/analysis_csv/step/step3/증가감소(추가)_'+str(num)+'.xlsx')
        
        # 시트 지정 하기
        sheet = wb['증가감소비교분석']

        #### 시트 인덱스를 이용하여 글, 수식쓰기 ####
        ## 이평선 비교 ##
        # 5일 20일 종가
        sheet['B7'] = '=COUNTIF(증가!K2:K30000,"T")'
        sheet['B8'] = '=COUNTIF(증가!K2:K30000,"F")'
        sheet['B9'] = '=(B7/(B7+B8))*100'
        sheet['D7'] = '=COUNTIF(감소!K2:K30000,"T")'
        sheet['D8'] = '=COUNTIF(감소!K2:K30000,"F")'
        sheet['D9'] = '=(D7/(D7+D8))*100'


        ## 기타사항 ##
        # 증가데이터와 감소데이터 수
        sheet['G7'] = '=COUNT(증가!A2:A30000)'
        sheet['I7'] = '=COUNT(감소!A2:A30000)'
        sheet['J7'] = '=(G7/(G7+I7))*100'
        
        # 종가-최대값 증가율 비교
        sheet['G13'] = '=COUNTIFS(증가!I2:I30000,"<10")'
        sheet['G14'] = '=COUNTIFS(증가!I2:I30000,">=10",증가!I2:I30000,"<20")'
        sheet['G15'] = '=COUNTIFS(증가!I2:I30000,">=20")'
        sheet['I13'] = '=COUNTIFS(감소!I2:I30000,">-10")'
        sheet['I14'] = '=COUNTIFS(감소!I2:I30000,"<=-10",감소!I2:I30000,">-20")'
        sheet['I15'] = '=COUNTIFS(감소!I2:I30000,"<=-20")'
        
        # 종가-최소값 감소율 비교
        sheet['G20'] = '=COUNTIFS(증가!J2:J30000,"<0")'
        sheet['G21'] = '=COUNTIFS(증가!J2:J30000,">=0")'
        sheet['I20'] = '=COUNTIFS(감소!J2:J30000,"<0")'
        sheet['I21'] = '=COUNTIFS(감소!J2:J30000,">=0")'

        
        ## 기준일 거래량과 과거 최대거래량 비교 ##
        # 기준일거래량_20전의_몇배
        sheet['M8'] = '=COUNTIFS(증가!L2:L30000,"<=1")'
        sheet['M9'] = '=COUNTIFS(증가!L2:L30000,">1",증가!L2:L30000,"<=10")' 
        sheet['M10'] = '=COUNTIFS(증가!L2:L30000,">10",증가!L2:L30000,"<=20")'
        sheet['M11'] = '=COUNTIFS(증가!L2:L30000,">20",증가!L2:L30000,"<=30")'
        sheet['M12'] = '=COUNTIFS(증가!L2:L30000,">30",증가!L2:L30000,"<=40")'
        sheet['M13'] = '=COUNTIFS(증가!L2:L30000,">40",증가!L2:L30000,"<=50")'
        sheet['M14'] = '=COUNTIFS(증가!L2:L30000,">50",증가!L2:L30000,"<=60")'
        sheet['M15'] = '=COUNTIFS(증가!L2:L30000,">60")'
        sheet['O8'] = '=COUNTIFS(감소!L2:L30000,"<=1")'
        sheet['O9'] = '=COUNTIFS(감소!L2:L30000,">1",감소!L2:L30000,"<=10")' 
        sheet['O10'] = '=COUNTIFS(감소!L2:L30000,">10",감소!L2:L30000,"<=20")'
        sheet['O11'] = '=COUNTIFS(감소!L2:L30000,">20",감소!L2:L30000,"<=30")'
        sheet['O12'] = '=COUNTIFS(감소!L2:L30000,">30",감소!L2:L30000,"<=40")'
        sheet['O13'] = '=COUNTIFS(감소!L2:L30000,">40",감소!L2:L30000,"<=50")'
        sheet['O14'] = '=COUNTIFS(감소!L2:L30000,">50",감소!L2:L30000,"<=60")'
        sheet['O15'] = '=COUNTIFS(감소!L2:L30000,">60")'
        sheet['P8'] = '=(M8/(M8+O8))*100'        
        sheet['P9'] = '=(M9/(M9+O9))*100'
        sheet['P10'] = '=(M10/(M10+O10))*100'
        sheet['P11'] = '=(M11/(M11+O11))*100'
        sheet['P12'] = '=(M12/(M12+O12))*100'
        sheet['P13'] = '=(M13/(M13+O13))*100'
        sheet['P14'] = '=(M14/(M14+O14))*100'
        sheet['P15'] = '=(M15/(M15+O15))*100'

        # 기준일거래량_60전의_몇배
        sheet['M21'] = '=COUNTIFS(증가!M2:M30000,"<=1")'
        sheet['M22'] = '=COUNTIFS(증가!M2:M30000,">1",증가!M2:M30000,"<=10")' 
        sheet['M23'] = '=COUNTIFS(증가!M2:M30000,">10",증가!M2:M30000,"<=20")'
        sheet['M24'] = '=COUNTIFS(증가!M2:M30000,">20",증가!M2:M30000,"<=30")'
        sheet['M25'] = '=COUNTIFS(증가!M2:M30000,">30",증가!M2:M30000,"<=40")'
        sheet['M26'] = '=COUNTIFS(증가!M2:M30000,">40",증가!M2:M30000,"<=50")'
        sheet['M27'] = '=COUNTIFS(증가!M2:M30000,">50",증가!M2:M30000,"<=60")'
        sheet['M28'] = '=COUNTIFS(증가!M2:M30000,">60")'
        sheet['O21'] = '=COUNTIFS(감소!M2:M30000,"<=1")'
        sheet['O22'] = '=COUNTIFS(감소!M2:M30000,">1",감소!M2:M30000,"<=10")' 
        sheet['O23'] = '=COUNTIFS(감소!M2:M30000,">10",감소!M2:M30000,"<=20")'
        sheet['O24'] = '=COUNTIFS(감소!M2:M30000,">20",감소!M2:M30000,"<=30")'
        sheet['O25'] = '=COUNTIFS(감소!M2:M30000,">30",감소!M2:M30000,"<=40")'
        sheet['O26'] = '=COUNTIFS(감소!M2:M30000,">40",감소!M2:M30000,"<=50")'
        sheet['O27'] = '=COUNTIFS(감소!M2:M30000,">50",감소!M2:M30000,"<=60")'
        sheet['O28'] = '=COUNTIFS(감소!M2:M30000,">60")'
        sheet['P21'] = '=(M21/(M21+O21))*100'        
        sheet['P22'] = '=(M22/(M22+O22))*100'
        sheet['P23'] = '=(M23/(M23+O23))*100'
        sheet['P24'] = '=(M24/(M24+O24))*100'
        sheet['P25'] = '=(M25/(M25+O25))*100'
        sheet['P26'] = '=(M26/(M26+O26))*100'
        sheet['P27'] = '=(M27/(M27+O27))*100'
        sheet['P28'] = '=(M28/(M28+O28))*100'


        ## 기준일 거래량과 과거 거래량 크기 비교 ##
        # 기준일거래량_20전의_많은수
        sheet['S8'] = '=COUNTIFS(증가!N2:N30000,"0")'
        sheet['S9'] = '=COUNTIFS(증가!N2:N30000,">0", 증가!N2:N30000,"<=5")'
        sheet['S10'] = '=COUNTIFS(증가!N2:N30000,">5", 증가!N2:N30000,"<=10")'
        sheet['S11'] = '=COUNTIFS(증가!N2:N30000,">10", 증가!N2:N30000,"<=15")'
        sheet['S12'] = '=COUNTIFS(증가!N2:N30000,">15", 증가!N2:N30000,"<=20")'
        sheet['U8'] = '=COUNTIFS(감소!N2:N30000,"0")'
        sheet['U9'] = '=COUNTIFS(감소!N2:N30000,">0", 감소!N2:N30000,"<=5")'
        sheet['U10'] = '=COUNTIFS(감소!N2:N30000,">5", 감소!N2:N30000,"<=10")'
        sheet['U11'] = '=COUNTIFS(감소!N2:N30000,">10", 감소!N2:N30000,"<=15")'
        sheet['U12'] = '=COUNTIFS(감소!N2:N30000,">15", 감소!N2:N30000,"<=20")'     
        sheet['V8'] = '=(S8/(S8+U8))*100'        
        sheet['V9'] = '=(S9/(S9+U9))*100'
        sheet['V10'] = '=(S10/(S10+U10))*100'
        sheet['V11'] = '=(S11/(S11+U11))*100'
        sheet['V12'] = '=(S12/(S12+U12))*100'
        
        # 기준일거래량_60전의_많은수
        sheet['S18'] = '=COUNTIFS(증가!O2:O30000,"0")'
        sheet['S19'] = '=COUNTIFS(증가!O2:O30000,">0", 증가!O2:O30000,"<=10")'
        sheet['S20'] = '=COUNTIFS(증가!O2:O30000,">10", 증가!O2:O30000,"<=20")'
        sheet['S21'] = '=COUNTIFS(증가!O2:O30000,">20", 증가!O2:O30000,"<=30")'
        sheet['S22'] = '=COUNTIFS(증가!O2:O30000,">30", 증가!O2:O30000,"<=40")'
        sheet['S23'] = '=COUNTIFS(증가!O2:O30000,">40", 증가!O2:O30000,"<=50")'
        sheet['S24'] = '=COUNTIFS(증가!O2:O30000,">50", 증가!O2:O30000,"<=60")'
        sheet['U18'] = '=COUNTIFS(감소!O2:O30000,"0")'
        sheet['U19'] = '=COUNTIFS(감소!O2:O30000,">0", 감소!O2:O30000,"<=10")'
        sheet['U20'] = '=COUNTIFS(감소!O2:O30000,">10", 감소!O2:O30000,"<=20")'
        sheet['U21'] = '=COUNTIFS(감소!O2:O30000,">20", 감소!O2:O30000,"<=30")'
        sheet['U22'] = '=COUNTIFS(감소!O2:O30000,">30", 감소!O2:O30000,"<=40")'    
        sheet['U23'] = '=COUNTIFS(감소!O2:O30000,">40", 감소!O2:O30000,"<=50")'            
        sheet['U24'] = '=COUNTIFS(감소!O2:O30000,">50", 감소!O2:O30000,"<=60")'    
        sheet['V18'] = '=(S18/(S18+U18))*100'        
        sheet['V19'] = '=(S19/(S19+U19))*100'
        sheet['V20'] = '=(S20/(S20+U20))*100'
        sheet['V21'] = '=(S21/(S21+U21))*100'
        sheet['V22'] = '=(S22/(S22+U22))*100'
        sheet['V23'] = '=(S23/(S23+U23))*100'
        sheet['V24'] = '=(S24/(S24+U24))*100'
        
        # 기준일거래량_6개월전의_많은수
        sheet['S30'] = '=COUNTIFS(증가!P2:P30000,"0")'
        sheet['S31'] = '=COUNTIFS(증가!P2:P30000,">0", 증가!P2:P30000,"<=20")'
        sheet['S32'] = '=COUNTIFS(증가!P2:P30000,">20", 증가!P2:P30000,"<=40")'
        sheet['S33'] = '=COUNTIFS(증가!P2:P30000,">40", 증가!P2:P30000,"<=60")'
        sheet['S34'] = '=COUNTIFS(증가!P2:P30000,">60", 증가!P2:P30000,"<=80")'
        sheet['S35'] = '=COUNTIFS(증가!P2:P30000,">80", 증가!P2:P30000,"<=100")'
        sheet['S36'] = '=COUNTIFS(증가!P2:P30000,">100", 증가!P2:P30000,"<=120")'
        sheet['U30'] = '=COUNTIFS(감소!P2:P30000,"0")'
        sheet['U31'] = '=COUNTIFS(감소!P2:P30000,">0", 감소!P2:P30000,"<=20")'
        sheet['U32'] = '=COUNTIFS(감소!P2:P30000,">20", 감소!P2:P30000,"<=40")'
        sheet['U33'] = '=COUNTIFS(감소!P2:P30000,">40", 감소!P2:P30000,"<=60")'
        sheet['U34'] = '=COUNTIFS(감소!P2:P30000,">60", 감소!P2:P30000,"<=80")'    
        sheet['U35'] = '=COUNTIFS(감소!P2:P30000,">80", 감소!P2:P30000,"<=100")'            
        sheet['U36'] = '=COUNTIFS(감소!P2:P30000,">100", 감소!P2:P30000,"<=120")'  
        sheet['V30'] = '=(S30/(S30+U30))*100'        
        sheet['V31'] = '=(S31/(S31+U31))*100'
        sheet['V32'] = '=(S32/(S32+U32))*100'
        sheet['V33'] = '=(S33/(S33+U33))*100'
        sheet['V34'] = '=(S34/(S34+U34))*100'
        sheet['V35'] = '=(S35/(S35+U35))*100'
        sheet['V36'] = '=(S36/(S36+U36))*100'

        # 기준일거래량_1년전의_많은수
        sheet['S42'] = '=COUNTIFS(증가!Q2:Q30000,"0")'
        sheet['S43'] = '=COUNTIFS(증가!Q2:Q30000,">0", 증가!Q2:Q30000,"<=40")'
        sheet['S44'] = '=COUNTIFS(증가!Q2:Q30000,">40", 증가!Q2:Q30000,"<=80")'
        sheet['S45'] = '=COUNTIFS(증가!Q2:Q30000,">80", 증가!Q2:Q30000,"<=120")'
        sheet['S46'] = '=COUNTIFS(증가!Q2:Q30000,">120", 증가!Q2:Q30000,"<=160")'
        sheet['S47'] = '=COUNTIFS(증가!Q2:Q30000,">160", 증가!Q2:Q30000,"<=200")'
        sheet['S48'] = '=COUNTIFS(증가!Q2:Q30000,">200", 증가!Q2:Q30000,"<=240")'
        sheet['U42'] = '=COUNTIFS(감소!Q2:Q30000,"0")'
        sheet['U43'] = '=COUNTIFS(감소!Q2:Q30000,">0", 감소!Q2:Q30000,"<=40")'
        sheet['U44'] = '=COUNTIFS(감소!Q2:Q30000,">40", 감소!Q2:Q30000,"<=80")'
        sheet['U45'] = '=COUNTIFS(감소!Q2:Q30000,">80", 감소!Q2:Q30000,"<=120")'
        sheet['U46'] = '=COUNTIFS(감소!Q2:Q30000,">120", 감소!Q2:Q30000,"<=160")'    
        sheet['U47'] = '=COUNTIFS(감소!Q2:Q30000,">160", 감소!Q2:Q30000,"<=200")'            
        sheet['U48'] = '=COUNTIFS(감소!Q2:Q30000,">200", 감소!Q2:Q30000,"<=240")'  
        sheet['V42'] = '=(S42/(S42+U42))*100'        
        sheet['V43'] = '=(S43/(S43+U43))*100'
        sheet['V44'] = '=(S44/(S44+U44))*100'
        sheet['V45'] = '=(S45/(S45+U45))*100'
        sheet['V46'] = '=(S46/(S46+U46))*100'
        sheet['V47'] = '=(S47/(S47+U47))*100'
        sheet['V48'] = '=(S48/(S48+U48))*100'
        
        
        ## 최소값이 점점 증가 or 감소하는지 확인하기 위함 ## 
        # 기준일저가_20전최소값의_몇배
        sheet['Y8'] = '=COUNTIFS(증가!R2:R30000,"<1")'
        sheet['Y9'] = '=COUNTIFS(증가!R2:R30000,">=1", 증가!R2:R30000,"<1.3")'
        sheet['Y10'] = '=COUNTIFS(증가!R2:R30000,">=1.3", 증가!R2:R30000,"<1.5")'
        sheet['Y11'] = '=COUNTIFS(증가!R2:R30000,">=1.5", 증가!R2:R30000,"<2")'
        sheet['Y12'] = '=COUNTIFS(증가!R2:R30000,">=2")'
        sheet['AA8'] = '=COUNTIFS(감소!R2:R30000,"<1")'
        sheet['AA9'] = '=COUNTIFS(감소!R2:R30000,">=1", 감소!R2:R30000,"<1.3")'
        sheet['AA10'] = '=COUNTIFS(감소!R2:R30000,">=1.3", 감소!R2:R30000,"<1.5")'
        sheet['AA11'] = '=COUNTIFS(감소!R2:R30000,">=1.5", 감소!R2:R30000,"<2")'
        sheet['AA12'] = '=COUNTIFS(감소!R2:R30000,">=2")'     
        sheet['AB8'] = '=(Y8/(Y8+AA8))*100'        
        sheet['AB9'] = '=(Y9/(Y9+AA9))*100'
        sheet['AB10'] = '=(Y10/(Y10+AA10))*100'
        sheet['AB11'] = '=(Y11/(Y11+AA11))*100'
        sheet['AB12'] = '=(Y12/(Y12+AA12))*100'

        # 20전최소값_60전최소값의_몇배
        sheet['Y18'] = '=COUNTIFS(증가!S2:S30000,"<1")'
        sheet['Y19'] = '=COUNTIFS(증가!S2:S30000,">=1", 증가!S2:S30000,"<1.3")'
        sheet['Y20'] = '=COUNTIFS(증가!S2:S30000,">=1.3", 증가!S2:S30000,"<1.5")'
        sheet['Y21'] = '=COUNTIFS(증가!S2:S30000,">=1.5", 증가!S2:S30000,"<2")'
        sheet['Y22'] = '=COUNTIFS(증가!S2:S30000,">=2")'
        sheet['AA18'] = '=COUNTIFS(감소!S2:S30000,"<1")'
        sheet['AA19'] = '=COUNTIFS(감소!S2:S30000,">=1", 감소!S2:S30000,"<1.3")'
        sheet['AA20'] = '=COUNTIFS(감소!S2:S30000,">=1.3", 감소!S2:S30000,"<1.5")'
        sheet['AA21'] = '=COUNTIFS(감소!S2:S30000,">=1.5", 감소!S2:S30000,"<2")'
        sheet['AA22'] = '=COUNTIFS(감소!S2:S30000,">=2")'     
        sheet['AB18'] = '=(Y18/(Y18+AA18))*100'        
        sheet['AB19'] = '=(Y19/(Y19+AA19))*100'
        sheet['AB20'] = '=(Y20/(Y20+AA20))*100'
        sheet['AB21'] = '=(Y21/(Y21+AA21))*100'
        sheet['AB22'] = '=(Y22/(Y22+AA22))*100'


        ## 기준일종가가 과거 최소값에 비해 너무 증가하지 않았나 확인 ##
        # 기준일종가_20전최소값의_몇배
        sheet['AE8'] = '=COUNTIFS(증가!T2:T30000,"<1")'
        sheet['AE9'] = '=COUNTIFS(증가!T2:T30000,">=1", 증가!T2:T30000,"<1.3")'
        sheet['AE10'] = '=COUNTIFS(증가!T2:T30000,">=1.3", 증가!T2:T30000,"<1.5")'
        sheet['AE11'] = '=COUNTIFS(증가!T2:T30000,">=1.5", 증가!T2:T30000,"<2")'
        sheet['AE12'] = '=COUNTIFS(증가!T2:T30000,">=2")'
        sheet['AG8'] = '=COUNTIFS(감소!T2:T30000,"<1")'
        sheet['AG9'] = '=COUNTIFS(감소!T2:T30000,">=1", 감소!T2:T30000,"<1.3")'
        sheet['AG10'] = '=COUNTIFS(감소!T2:T30000,">=1.3", 감소!T2:T30000,"<1.5")'
        sheet['AG11'] = '=COUNTIFS(감소!T2:T30000,">=1.5", 감소!T2:T30000,"<2")'
        sheet['AG12'] = '=COUNTIFS(감소!T2:T30000,">=2")'     
        sheet['AH8'] = '=(AE8/(AE8+AG8))*100'        
        sheet['AH9'] = '=(AE9/(AE9+AG9))*100'
        sheet['AH10'] = '=(AE10/(AE10+AG10))*100'
        sheet['AH11'] = '=(AE11/(AE11+AG11))*100'
        sheet['AH12'] = '=(AE12/(AE12+AG12))*100'        
        
        # 기준일종가_60전최소값의_몇배
        sheet['AE18'] = '=COUNTIFS(증가!U2:U30000,"<1")'
        sheet['AE19'] = '=COUNTIFS(증가!U2:U30000,">=1", 증가!U2:U30000,"<1.3")'
        sheet['AE20'] = '=COUNTIFS(증가!U2:U30000,">=1.3", 증가!U2:U30000,"<1.5")'
        sheet['AE21'] = '=COUNTIFS(증가!U2:U30000,">=1.5", 증가!U2:U30000,"<2")'
        sheet['AE22'] = '=COUNTIFS(증가!U2:U30000,">=2")'
        sheet['AG18'] = '=COUNTIFS(감소!U2:U30000,"<1")'
        sheet['AG19'] = '=COUNTIFS(감소!U2:U30000,">=1", 감소!U2:U30000,"<1.3")'
        sheet['AG20'] = '=COUNTIFS(감소!U2:U30000,">=1.3", 감소!U2:U30000,"<1.5")'
        sheet['AG21'] = '=COUNTIFS(감소!U2:U30000,">=1.5", 감소!U2:U30000,"<2")'
        sheet['AG22'] = '=COUNTIFS(감소!U2:U30000,">=2")'     
        sheet['AH18'] = '=(AE18/(AE18+AG18))*100'        
        sheet['AH19'] = '=(AE19/(AE19+AG19))*100'
        sheet['AH20'] = '=(AE20/(AE20+AG20))*100'
        sheet['AH21'] = '=(AE21/(AE21+AG21))*100'
        sheet['AH22'] = '=(AE22/(AE22+AG22))*100'


        ## 기준일 전 n% 이상의 봉수가 몇번 나타났었는지 확인 ## 
        # 20전_15%이상의_봉수
        sheet['AK8'] = '=COUNTIFS(증가!V2:V30000,"0")'
        sheet['AK9'] = '=COUNTIFS(증가!V2:V30000,"1")'
        sheet['AK10'] = '=COUNTIFS(증가!V2:V30000,"2")'
        sheet['AK11'] = '=COUNTIFS(증가!V2:V30000,"3")'
        sheet['AK12'] = '=COUNTIFS(증가!V2:V30000,"4")'
        sheet['AK13'] = '=COUNTIFS(증가!V2:V30000,"5")'
        sheet['AK14'] = '=COUNTIFS(증가!V2:V30000,">5")'
        sheet['AM8'] = '=COUNTIFS(감소!V2:V30000,"0")'
        sheet['AM9'] = '=COUNTIFS(감소!V2:V30000,"1")'
        sheet['AM10'] = '=COUNTIFS(감소!V2:V30000,"2")'
        sheet['AM11'] = '=COUNTIFS(감소!V2:V30000,"3")'
        sheet['AM12'] = '=COUNTIFS(감소!V2:V30000,"4")'    
        sheet['AM13'] = '=COUNTIFS(감소!V2:V30000,"5")'            
        sheet['AM14'] = '=COUNTIFS(감소!V2:V30000,">5")'    
        sheet['AN8'] = '=(AK8/(AK8+AM8))*100'        
        sheet['AN9'] = '=(AK9/(AK9+AM9))*100'
        sheet['AN10'] = '=(AK10/(AK10+AM10))*100'
        sheet['AN11'] = '=(AK11/(AK11+AM11))*100'
        sheet['AN12'] = '=(AK12/(AK12+AM12))*100'
        sheet['AN13'] = '=(AK13/(AK13+AM13))*100'
        sheet['AN14'] = '=(AK14/(AK14+AM14))*100'
        
        # 60전_15%이상의_봉수
        sheet['AK20'] = '=COUNTIFS(증가!W2:W30000,"0")'
        sheet['AK21'] = '=COUNTIFS(증가!W2:W30000,"1")'
        sheet['AK22'] = '=COUNTIFS(증가!W2:W30000,"2")'
        sheet['AK23'] = '=COUNTIFS(증가!W2:W30000,"3")'
        sheet['AK24'] = '=COUNTIFS(증가!W2:W30000,"4")'
        sheet['AK25'] = '=COUNTIFS(증가!W2:W30000,"5")'
        sheet['AK26'] = '=COUNTIFS(증가!W2:W30000,">5")'
        sheet['AM20'] = '=COUNTIFS(감소!W2:W30000,"0")'
        sheet['AM21'] = '=COUNTIFS(감소!W2:W30000,"1")'
        sheet['AM22'] = '=COUNTIFS(감소!W2:W30000,"2")'
        sheet['AM23'] = '=COUNTIFS(감소!W2:W30000,"3")'
        sheet['AM24'] = '=COUNTIFS(감소!W2:W30000,"4")'    
        sheet['AM25'] = '=COUNTIFS(감소!W2:W30000,"5")'            
        sheet['AM26'] = '=COUNTIFS(감소!W2:W30000,">5")'    
        sheet['AN20'] = '=(AK20/(AK20+AM20))*100'        
        sheet['AN21'] = '=(AK21/(AK21+AM21))*100'
        sheet['AN22'] = '=(AK22/(AK22+AM22))*100'
        sheet['AN23'] = '=(AK23/(AK23+AM23))*100'
        sheet['AN24'] = '=(AK24/(AK24+AM24))*100'
        sheet['AN25'] = '=(AK25/(AK25+AM25))*100'
        sheet['AN26'] = '=(AK26/(AK26+AM26))*100'
        
        # 6개월전_15%이상의_봉수
        sheet['AK32'] = '=COUNTIFS(증가!X2:X30000,"0")'
        sheet['AK33'] = '=COUNTIFS(증가!X2:X30000,"1")'
        sheet['AK34'] = '=COUNTIFS(증가!X2:X30000,"2")'
        sheet['AK35'] = '=COUNTIFS(증가!X2:X30000,"3")'
        sheet['AK36'] = '=COUNTIFS(증가!X2:X30000,"4")'
        sheet['AK37'] = '=COUNTIFS(증가!X2:X30000,"5")'
        sheet['AK38'] = '=COUNTIFS(증가!X2:X30000,">5")'
        sheet['AM32'] = '=COUNTIFS(감소!X2:X30000,"0")'
        sheet['AM33'] = '=COUNTIFS(감소!X2:X30000,"1")'
        sheet['AM34'] = '=COUNTIFS(감소!X2:X30000,"2")'
        sheet['AM35'] = '=COUNTIFS(감소!X2:X30000,"3")'
        sheet['AM36'] = '=COUNTIFS(감소!X2:X30000,"4")'    
        sheet['AM37'] = '=COUNTIFS(감소!X2:X30000,"5")'            
        sheet['AM38'] = '=COUNTIFS(감소!X2:X30000,">5")'    
        sheet['AN32'] = '=(AK32/(AK32+AM32))*100'        
        sheet['AN33'] = '=(AK33/(AK33+AM33))*100'
        sheet['AN34'] = '=(AK34/(AK34+AM34))*100'
        sheet['AN35'] = '=(AK35/(AK35+AM35))*100'
        sheet['AN36'] = '=(AK36/(AK36+AM36))*100'
        sheet['AN37'] = '=(AK37/(AK37+AM37))*100'
        sheet['AN38'] = '=(AK38/(AK38+AM38))*100'
        
        # 1년전_15%이상의_봉수
        sheet['AK44'] = '=COUNTIFS(증가!Y2:Y30000,"0")'
        sheet['AK45'] = '=COUNTIFS(증가!Y2:Y30000,"1")'
        sheet['AK46'] = '=COUNTIFS(증가!Y2:Y30000,"2")'
        sheet['AK47'] = '=COUNTIFS(증가!Y2:Y30000,"3")'
        sheet['AK48'] = '=COUNTIFS(증가!Y2:Y30000,"4")'
        sheet['AK49'] = '=COUNTIFS(증가!Y2:Y30000,"5")'
        sheet['AK50'] = '=COUNTIFS(증가!Y2:Y30000,">5")'
        sheet['AM44'] = '=COUNTIFS(감소!Y2:Y30000,"0")'
        sheet['AM45'] = '=COUNTIFS(감소!Y2:Y30000,"1")'
        sheet['AM46'] = '=COUNTIFS(감소!Y2:Y30000,"2")'
        sheet['AM47'] = '=COUNTIFS(감소!Y2:Y30000,"3")'
        sheet['AM48'] = '=COUNTIFS(감소!Y2:Y30000,"4")'    
        sheet['AM49'] = '=COUNTIFS(감소!Y2:Y30000,"5")'            
        sheet['AM50'] = '=COUNTIFS(감소!Y2:Y30000,">5")'    
        sheet['AN44'] = '=(AK44/(AK44+AM44))*100'        
        sheet['AN45'] = '=(AK45/(AK45+AM45))*100'
        sheet['AN46'] = '=(AK46/(AK46+AM46))*100'
        sheet['AN47'] = '=(AK47/(AK47+AM47))*100'
        sheet['AN48'] = '=(AK48/(AK48+AM48))*100'
        sheet['AN49'] = '=(AK49/(AK49+AM49))*100'
        sheet['AN50'] = '=(AK50/(AK50+AM50))*100'


        ## 기준일 전 -n% 이하의 봉수가 몇번 나타났었는지 확인 ## 
        # 20전_15%이하의_봉수
        sheet['AQ8'] = '=COUNTIFS(증가!Z2:Z30000,"0")'
        sheet['AQ9'] = '=COUNTIFS(증가!Z2:Z30000,"1")'
        sheet['AQ10'] = '=COUNTIFS(증가!Z2:Z30000,"2")'
        sheet['AQ11'] = '=COUNTIFS(증가!Z2:Z30000,"3")'
        sheet['AQ12'] = '=COUNTIFS(증가!Z2:Z30000,"4")'
        sheet['AQ13'] = '=COUNTIFS(증가!Z2:Z30000,"5")'
        sheet['AQ14'] = '=COUNTIFS(증가!Z2:Z30000,">5")'
        sheet['AS8'] = '=COUNTIFS(감소!Z2:Z30000,"0")'
        sheet['AS9'] = '=COUNTIFS(감소!Z2:Z30000,"1")'
        sheet['AS10'] = '=COUNTIFS(감소!Z2:Z30000,"2")'
        sheet['AS11'] = '=COUNTIFS(감소!Z2:Z30000,"3")'
        sheet['AS12'] = '=COUNTIFS(감소!Z2:Z30000,"4")'    
        sheet['AS13'] = '=COUNTIFS(감소!Z2:Z30000,"5")'            
        sheet['AS14'] = '=COUNTIFS(감소!Z2:Z30000,">5")'    
        sheet['AT8'] = '=(AQ8/(AQ8+AS8))*100'        
        sheet['AT9'] = '=(AQ9/(AQ9+AS9))*100'
        sheet['AT10'] = '=(AQ10/(AQ10+AS10))*100'
        sheet['AT11'] = '=(AQ11/(AQ11+AS11))*100'
        sheet['AT12'] = '=(AQ12/(AQ12+AS12))*100'
        sheet['AT13'] = '=(AQ13/(AQ13+AS13))*100'
        sheet['AT14'] = '=(AQ14/(AQ14+AS14))*100'
        
        # 60전_15%이하의_봉수
        sheet['AQ20'] = '=COUNTIFS(증가!AA2:AA30000,"0")'
        sheet['AQ21'] = '=COUNTIFS(증가!AA2:AA30000,"1")'
        sheet['AQ22'] = '=COUNTIFS(증가!AA2:AA30000,"2")'
        sheet['AQ23'] = '=COUNTIFS(증가!AA2:AA30000,"3")'
        sheet['AQ24'] = '=COUNTIFS(증가!AA2:AA30000,"4")'
        sheet['AQ25'] = '=COUNTIFS(증가!AA2:AA30000,"5")'
        sheet['AQ26'] = '=COUNTIFS(증가!AA2:AA30000,">5")'
        sheet['AS20'] = '=COUNTIFS(감소!AA2:AA30000,"0")'
        sheet['AS21'] = '=COUNTIFS(감소!AA2:AA30000,"1")'
        sheet['AS22'] = '=COUNTIFS(감소!AA2:AA30000,"2")'
        sheet['AS23'] = '=COUNTIFS(감소!AA2:AA30000,"3")'
        sheet['AS24'] = '=COUNTIFS(감소!AA2:AA30000,"4")'    
        sheet['AS25'] = '=COUNTIFS(감소!AA2:AA30000,"5")'            
        sheet['AS26'] = '=COUNTIFS(감소!AA2:AA30000,">5")'    
        sheet['AT20'] = '=(AQ20/(AQ20+AS20))*100'        
        sheet['AT21'] = '=(AQ21/(AQ21+AS21))*100'
        sheet['AT22'] = '=(AQ22/(AQ22+AS22))*100'
        sheet['AT23'] = '=(AQ23/(AQ23+AS23))*100'
        sheet['AT24'] = '=(AQ24/(AQ24+AS24))*100'
        sheet['AT25'] = '=(AQ25/(AQ25+AS25))*100'
        sheet['AT26'] = '=(AQ26/(AQ26+AS26))*100'
        
        # 6개월전_15%이하의_봉수
        sheet['AQ32'] = '=COUNTIFS(증가!AB2:AB30000,"0")'
        sheet['AQ33'] = '=COUNTIFS(증가!AB2:AB30000,"1")'
        sheet['AQ34'] = '=COUNTIFS(증가!AB2:AB30000,"2")'
        sheet['AQ35'] = '=COUNTIFS(증가!AB2:AB30000,"3")'
        sheet['AQ36'] = '=COUNTIFS(증가!AB2:AB30000,"4")'
        sheet['AQ37'] = '=COUNTIFS(증가!AB2:AB30000,"5")'
        sheet['AQ38'] = '=COUNTIFS(증가!AB2:AB30000,">5")'
        sheet['AS32'] = '=COUNTIFS(감소!AB2:AB30000,"0")'
        sheet['AS33'] = '=COUNTIFS(감소!AB2:AB30000,"1")'
        sheet['AS34'] = '=COUNTIFS(감소!AB2:AB30000,"2")'
        sheet['AS35'] = '=COUNTIFS(감소!AB2:AB30000,"3")'
        sheet['AS36'] = '=COUNTIFS(감소!AB2:AB30000,"4")'    
        sheet['AS37'] = '=COUNTIFS(감소!AB2:AB30000,"5")'            
        sheet['AS38'] = '=COUNTIFS(감소!AB2:AB30000,">5")'    
        sheet['AT32'] = '=(AQ32/(AQ32+AS32))*100'        
        sheet['AT33'] = '=(AQ33/(AQ33+AS33))*100'
        sheet['AT34'] = '=(AQ34/(AQ34+AS34))*100'
        sheet['AT35'] = '=(AQ35/(AQ35+AS35))*100'
        sheet['AT36'] = '=(AQ36/(AQ36+AS36))*100'
        sheet['AT37'] = '=(AQ37/(AQ37+AS37))*100'
        sheet['AT38'] = '=(AQ38/(AQ38+AS38))*100'
        
        # 1년전_15%이하의_봉수
        sheet['AQ44'] = '=COUNTIFS(증가!AC2:AC30000,"0")'
        sheet['AQ45'] = '=COUNTIFS(증가!AC2:AC30000,"1")'
        sheet['AQ46'] = '=COUNTIFS(증가!AC2:AC30000,"2")'
        sheet['AQ47'] = '=COUNTIFS(증가!AC2:AC30000,"3")'
        sheet['AQ48'] = '=COUNTIFS(증가!AC2:AC30000,"4")'
        sheet['AQ49'] = '=COUNTIFS(증가!AC2:AC30000,"5")'
        sheet['AQ50'] = '=COUNTIFS(증가!AC2:AC30000,">5")'
        sheet['AS44'] = '=COUNTIFS(감소!AC2:AC30000,"0")'
        sheet['AS45'] = '=COUNTIFS(감소!AC2:AC30000,"1")'
        sheet['AS46'] = '=COUNTIFS(감소!AC2:AC30000,"2")'
        sheet['AS47'] = '=COUNTIFS(감소!AC2:AC30000,"3")'
        sheet['AS48'] = '=COUNTIFS(감소!AC2:AC30000,"4")'    
        sheet['AS49'] = '=COUNTIFS(감소!AC2:AC30000,"5")'            
        sheet['AS50'] = '=COUNTIFS(감소!AC2:AC30000,">5")'    
        sheet['AT44'] = '=(AQ44/(AQ44+AS44))*100'        
        sheet['AT45'] = '=(AQ45/(AQ45+AS45))*100'
        sheet['AT46'] = '=(AQ46/(AQ46+AS46))*100'
        sheet['AT47'] = '=(AQ47/(AQ47+AS47))*100'
        sheet['AT48'] = '=(AQ48/(AQ48+AS48))*100'
        sheet['AT49'] = '=(AQ49/(AQ49+AS49))*100'
        sheet['AT50'] = '=(AQ50/(AQ50+AS50))*100'
        
        
        ## 기준일 전 기준일 고가보다 높았던 봉이 몇 개이었는지 ## 
        # 기준일고가보다_높았던봉수(1년)
        sheet['AW8'] = '=COUNTIFS(증가!AD2:AD30000,"0")'
        sheet['AW9'] = '=COUNTIFS(증가!AD2:AD30000,"1")'
        sheet['AW10'] = '=COUNTIFS(증가!AD2:AD30000,"2")'
        sheet['AW11'] = '=COUNTIFS(증가!AD2:AD30000,"3")'
        sheet['AW12'] = '=COUNTIFS(증가!AD2:AD30000,"4")'
        sheet['AW13'] = '=COUNTIFS(증가!AD2:AD30000,"5")'
        sheet['AW14'] = '=COUNTIFS(증가!AD2:AD30000,">5",증가!AD2:AD30000,"<=10")'
        sheet['AW15'] = '=COUNTIFS(증가!AD2:AD30000,">10",증가!AD2:AD30000,"<=20")'
        sheet['AW16'] = '=COUNTIFS(증가!AD2:AD30000,">20",증가!AD2:AD30000,"<=30")'
        sheet['AW17'] = '=COUNTIFS(증가!AD2:AD30000,">30",증가!AD2:AD30000,"<=40")'
        sheet['AW18'] = '=COUNTIFS(증가!AD2:AD30000,">40",증가!AD2:AD30000,"<=50")'
        sheet['AW19'] = '=COUNTIFS(증가!AD2:AD30000,">50",증가!AD2:AD30000,"<=100")'
        sheet['AW20'] = '=COUNTIFS(증가!AD2:AD30000,">100")'
        sheet['AY8'] = '=COUNTIFS(감소!AD2:AD30000,"0")'
        sheet['AY9'] = '=COUNTIFS(감소!AD2:AD30000,"1")'
        sheet['AY10'] = '=COUNTIFS(감소!AD2:AD30000,"2")'
        sheet['AY11'] = '=COUNTIFS(감소!AD2:AD30000,"3")'
        sheet['AY12'] = '=COUNTIFS(감소!AD2:AD30000,"4")'    
        sheet['AY13'] = '=COUNTIFS(감소!AD2:AD30000,"5")'            
        sheet['AY14'] = '=COUNTIFS(감소!AD2:AD30000,">5",감소!AD2:AD30000,"<=10")'
        sheet['AY15'] = '=COUNTIFS(감소!AD2:AD30000,">10",감소!AD2:AD30000,"<=20")'
        sheet['AY16'] = '=COUNTIFS(감소!AD2:AD30000,">20",감소!AD2:AD30000,"<=30")'
        sheet['AY17'] = '=COUNTIFS(감소!AD2:AD30000,">30",감소!AD2:AD30000,"<=40")'
        sheet['AY18'] = '=COUNTIFS(감소!AD2:AD30000,">40",감소!AD2:AD30000,"<=50")'
        sheet['AY19'] = '=COUNTIFS(감소!AD2:AD30000,">50",감소!AD2:AD30000,"<=100")'
        sheet['AY20'] = '=COUNTIFS(감소!AD2:AD30000,">100")'
        sheet['AZ8'] = '=(AW8/(AW8+AY8))*100'        
        sheet['AZ9'] = '=(AW9/(AW9+AY9))*100'
        sheet['AZ10'] = '=(AW10/(AW10+AY10))*100'
        sheet['AZ11'] = '=(AW11/(AW11+AY11))*100'
        sheet['AZ12'] = '=(AW12/(AW12+AY12))*100'
        sheet['AZ13'] = '=(AW13/(AW13+AY13))*100'
        sheet['AZ14'] = '=(AW14/(AW14+AY14))*100'
        sheet['AZ15'] = '=(AW15/(AW15+AY15))*100'
        sheet['AZ16'] = '=(AW16/(AW16+AY16))*100'
        sheet['AZ17'] = '=(AW17/(AW17+AY17))*100'
        sheet['AZ18'] = '=(AW18/(AW18+AY18))*100'
        sheet['AZ19'] = '=(AW19/(AW19+AY19))*100'
        sheet['AZ20'] = '=(AW20/(AW20+AY20))*100'
        
        
        ## 1년전 최대, 최소값과 기준일과의 관계, 1년전 최대, 최소값의 등락폭 ##
        # 1년전최대값_기준일고가의_몇배
        sheet['BC8'] = '=COUNTIFS(증가!AE2:AE30000,">=0",증가!AE2:AE30000,"<0.5")'
        sheet['BC9'] = '=COUNTIFS(증가!AE2:AE30000,">=0.5",증가!AE2:AE30000,"<0.7")'
        sheet['BC10'] = '=COUNTIFS(증가!AE2:AE30000,">=0.7",증가!AE2:AE30000,"<1")'
        sheet['BC11'] = '=COUNTIFS(증가!AE2:AE30000,">=1",증가!AE2:AE30000,"<1.3")'
        sheet['BC12'] = '=COUNTIFS(증가!AE2:AE30000,">=1.3",증가!AE2:AE30000,"<1.5")'
        sheet['BC13'] = '=COUNTIFS(증가!AE2:AE30000,">=1.5",증가!AE2:AE30000,"<2")'
        sheet['BC14'] = '=COUNTIFS(증가!AE2:AE30000,">=2",증가!AE2:AE30000,"<3")'
        sheet['BC15'] = '=COUNTIFS(증가!AE2:AE30000,">=3")'
        sheet['BE8'] = '=COUNTIFS(감소!AE2:AE30000,">=0",감소!AE2:AE30000,"<0.5")'
        sheet['BE9'] = '=COUNTIFS(감소!AE2:AE30000,">=0.5",감소!AE2:AE30000,"<0.7")'
        sheet['BE10'] = '=COUNTIFS(감소!AE2:AE30000,">=0.7",감소!AE2:AE30000,"<1")'
        sheet['BE11'] = '=COUNTIFS(감소!AE2:AE30000,">=1",감소!AE2:AE30000,"<1.3")'
        sheet['BE12'] = '=COUNTIFS(감소!AE2:AE30000,">=1.3",감소!AE2:AE30000,"<1.5")'
        sheet['BE13'] = '=COUNTIFS(감소!AE2:AE30000,">=1.5",감소!AE2:AE30000,"<2")'
        sheet['BE14'] = '=COUNTIFS(감소!AE2:AE30000,">=2",감소!AE2:AE30000,"<3")'
        sheet['BE15'] = '=COUNTIFS(감소!AE2:AE30000,">=3")'
        sheet['BF8'] = '=(BC8/(BC8+BE8))*100'        
        sheet['BF9'] = '=(BC9/(BC9+BE9))*100'
        sheet['BF10'] = '=(BC10/(BC10+BE10))*100'
        sheet['BF11'] = '=(BC11/(BC11+BE11))*100'
        sheet['BF12'] = '=(BC12/(BC12+BE12))*100'
        sheet['BF13'] = '=(BC13/(BC13+BE13))*100'
        sheet['BF14'] = '=(BC14/(BC14+BE14))*100'
        sheet['BF15'] = '=(BC15/(BC15+BE15))*100'
        
        # 기준일저가_1년전최소값의_몇배
        sheet['BC21'] = '=COUNTIFS(증가!AF2:AF30000,">=0",증가!AF2:AF30000,"<0.5")'
        sheet['BC22'] = '=COUNTIFS(증가!AF2:AF30000,">=0.5",증가!AF2:AF30000,"<0.7")'
        sheet['BC23'] = '=COUNTIFS(증가!AF2:AF30000,">=0.7",증가!AF2:AF30000,"<1")'
        sheet['BC24'] = '=COUNTIFS(증가!AF2:AF30000,">=1",증가!AF2:AF30000,"<1.3")'
        sheet['BC25'] = '=COUNTIFS(증가!AF2:AF30000,">=1.3",증가!AF2:AF30000,"<1.5")'
        sheet['BC26'] = '=COUNTIFS(증가!AF2:AF30000,">=1.5",증가!AF2:AF30000,"<2")'
        sheet['BC27'] = '=COUNTIFS(증가!AF2:AF30000,">=2",증가!AF2:AF30000,"<3")'
        sheet['BC28'] = '=COUNTIFS(증가!AF2:AF30000,">=3")'
        sheet['BE21'] = '=COUNTIFS(감소!AF2:AF30000,">=0",감소!AF2:AF30000,"<0.5")'
        sheet['BE22'] = '=COUNTIFS(감소!AF2:AF30000,">=0.5",감소!AF2:AF30000,"<0.7")'
        sheet['BE23'] = '=COUNTIFS(감소!AF2:AF30000,">=0.7",감소!AF2:AF30000,"<1")'
        sheet['BE24'] = '=COUNTIFS(감소!AF2:AF30000,">=1",감소!AF2:AF30000,"<1.3")'
        sheet['BE25'] = '=COUNTIFS(감소!AF2:AF30000,">=1.3",감소!AF2:AF30000,"<1.5")'
        sheet['BE26'] = '=COUNTIFS(감소!AF2:AF30000,">=1.5",감소!AF2:AF30000,"<2")'
        sheet['BE27'] = '=COUNTIFS(감소!AF2:AF30000,">=2",감소!AF2:AF30000,"<3")'
        sheet['BE28'] = '=COUNTIFS(감소!AF2:AF30000,">=3")'
        sheet['BF21'] = '=(BC21/(BC21+BE21))*100'        
        sheet['BF22'] = '=(BC22/(BC22+BE22))*100'
        sheet['BF23'] = '=(BC23/(BC23+BE23))*100'
        sheet['BF24'] = '=(BC24/(BC24+BE24))*100'
        sheet['BF25'] = '=(BC25/(BC25+BE25))*100'
        sheet['BF26'] = '=(BC26/(BC26+BE26))*100'
        sheet['BF27'] = '=(BC27/(BC27+BE27))*100'
        sheet['BF28'] = '=(BC28/(BC28+BE28))*100'
        
        # 1년전최대최소의중간값_기준일종가의_몇배
        sheet['BC34'] = '=COUNTIFS(증가!AG2:AG30000,">=0",증가!AG2:AG30000,"<0.5")'
        sheet['BC35'] = '=COUNTIFS(증가!AG2:AG30000,">=0.5",증가!AG2:AG30000,"<0.7")'
        sheet['BC36'] = '=COUNTIFS(증가!AG2:AG30000,">=0.7",증가!AG2:AG30000,"<1")'
        sheet['BC37'] = '=COUNTIFS(증가!AG2:AG30000,">=1",증가!AG2:AG30000,"<1.3")'
        sheet['BC38'] = '=COUNTIFS(증가!AG2:AG30000,">=1.3",증가!AG2:AG30000,"<1.5")'
        sheet['BC39'] = '=COUNTIFS(증가!AG2:AG30000,">=1.5",증가!AG2:AG30000,"<2")'
        sheet['BC40'] = '=COUNTIFS(증가!AG2:AG30000,">=2",증가!AG2:AG30000,"<3")'
        sheet['BC41'] = '=COUNTIFS(증가!AG2:AG30000,">=3")'
        sheet['BE34'] = '=COUNTIFS(감소!AG2:AG30000,">=0",감소!AG2:AG30000,"<0.5")'
        sheet['BE35'] = '=COUNTIFS(감소!AG2:AG30000,">=0.5",감소!AG2:AG30000,"<0.7")'
        sheet['BE36'] = '=COUNTIFS(감소!AG2:AG30000,">=0.7",감소!AG2:AG30000,"<1")'
        sheet['BE37'] = '=COUNTIFS(감소!AG2:AG30000,">=1",감소!AG2:AG30000,"<1.3")'
        sheet['BE38'] = '=COUNTIFS(감소!AG2:AG30000,">=1.3",감소!AG2:AG30000,"<1.5")'
        sheet['BE39'] = '=COUNTIFS(감소!AG2:AG30000,">=1.5",감소!AG2:AG30000,"<2")'
        sheet['BE40'] = '=COUNTIFS(감소!AG2:AG30000,">=2",감소!AG2:AG30000,"<3")'
        sheet['BE41'] = '=COUNTIFS(감소!AG2:AG30000,">=3")'
        sheet['BF34'] = '=(BC34/(BC34+BE34))*100'        
        sheet['BF35'] = '=(BC35/(BC35+BE35))*100'
        sheet['BF36'] = '=(BC36/(BC36+BE36))*100'
        sheet['BF37'] = '=(BC37/(BC37+BE37))*100'
        sheet['BF38'] = '=(BC38/(BC38+BE38))*100'
        sheet['BF39'] = '=(BC39/(BC39+BE39))*100'
        sheet['BF40'] = '=(BC40/(BC40+BE40))*100'
        sheet['BF41'] = '=(BC41/(BC41+BE41))*100'
        
        
        # 1년전최대값_1년전최소값의_몇%증가
        sheet['BC47'] = '=COUNTIFS(증가!AH2:AH30000,">=0",증가!AH2:AH30000,"<50")'
        sheet['BC48'] = '=COUNTIFS(증가!AH2:AH30000,">=50",증가!AH2:AH30000,"<100")'
        sheet['BC49'] = '=COUNTIFS(증가!AH2:AH30000,">=100",증가!AH2:AH30000,"<150")'
        sheet['BC50'] = '=COUNTIFS(증가!AH2:AH30000,">=150",증가!AH2:AH30000,"<200")'
        sheet['BC51'] = '=COUNTIFS(증가!AH2:AH30000,">=200",증가!AH2:AH30000,"<250")'
        sheet['BC52'] = '=COUNTIFS(증가!AH2:AH30000,">=250",증가!AH2:AH30000,"<300")'
        sheet['BC53'] = '=COUNTIFS(증가!AH2:AH30000,">=300")'
        sheet['BE47'] = '=COUNTIFS(감소!AH2:AH30000,">=0",감소!AH2:AH30000,"<50")'
        sheet['BE48'] = '=COUNTIFS(감소!AH2:AH30000,">=50",감소!AH2:AH30000,"<100")'
        sheet['BE49'] = '=COUNTIFS(감소!AH2:AH30000,">=100",감소!AH2:AH30000,"<150")'
        sheet['BE50'] = '=COUNTIFS(감소!AH2:AH30000,">=150",감소!AH2:AH30000,"<200")'
        sheet['BE51'] = '=COUNTIFS(감소!AH2:AH30000,">=200",감소!AH2:AH30000,"<250")'
        sheet['BE52'] = '=COUNTIFS(감소!AH2:AH30000,">=250",감소!AH2:AH30000,"<300")'
        sheet['BE53'] = '=COUNTIFS(감소!AH2:AH30000,">=300")'
        sheet['BF47'] = '=(BC47/(BC47+BE47))*100'        
        sheet['BF48'] = '=(BC48/(BC48+BE48))*100'
        sheet['BF49'] = '=(BC49/(BC49+BE49))*100'
        sheet['BF50'] = '=(BC50/(BC50+BE50))*100'
        sheet['BF51'] = '=(BC51/(BC51+BE51))*100'
        sheet['BF52'] = '=(BC52/(BC52+BE52))*100'
        sheet['BF53'] = '=(BC53/(BC53+BE53))*100'

        # 저장
        wb.save('F:/JusikData/analysis_csv/step/step3/증가감소(추가)_'+str(num)+'.xlsx')
        wb.close()




#conn = step4_cls()
#conn.make_step4(1)